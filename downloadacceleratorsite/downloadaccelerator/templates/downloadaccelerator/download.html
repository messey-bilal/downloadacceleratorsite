{% extends "downloadaccelerator/base.html" %}
{% load static %}

{% block css %}
<link rel="stylesheet" type="text/css" href="{% static 'downloadaccelerator/download.css' %}">
{% endblock css %}

{% block navigation %}
<div class="collapse navbar-collapse" id="navbarNav">
  <ul class="navbar-nav">
    <li class="nav-item">
      <a class="nav-link text-dark" style="font-weight: bold;" aria-current="page" href="{% url 'downloadaccelerator:home' %}">HOME</a>
    </li>
    <li class="nav-item">
      <a id="features" class="nav-link text-dark" style="font-weight: bold;" href="{% url 'downloadaccelerator:features' %}">FEATURES</a>
    </li>
    <li class="nav-item">
      <a class="nav-link text-dark" style="font-weight: bold;" href="#">ABOUT AUTHOR</a>
    </li>
    <li class="nav-item">
      <a class="nav-link active" style="font-weight: bold;" href="{% url 'downloadaccelerator:download' %}">DOWNLOAD</a>
    </li>
    <li class="nav-item">
      <a class="nav-link disabled" style="font-weight: bold;">SUPPORT</a>
    </li>
  </ul>
</div>
{% endblock navigation %}

{% block banner %}
<div class="main-banner d-flex flex-column justify-content-center">
	<img src="{% static 'downloadaccelerator/images/banner-download.png' %}" class="img-fluid" alt="" width="100%" height="auto">
    <div class="container-banner" id="text-banner-download">
        <h1 class="text-light">Download Accelerator Features</h1>
        <div class="text-light font-bold">Explore all Download Accelerator features</div>
        <button type="button" class="btn btn-success font-bold btn-download">TRY DOWNLOAD ACCELERATOR</button>
    </div>
</div>
{% endblock banner %}

{% block content %}
<div class="container">
    <div class="row g-5 p-4">
      <div class="col-sm-12 col-lg-6">
        <div class="p-3">
          <h2>Registration</h2>
          <p>Thus, you may access to the <a data-bs-toggle="modal" data-bs-target="#modal-connexion" href="">forums</a> and if you have any questions about Download Accelerator, you will contact its conceptor. So you can register <a data-bs-toggle="modal" data-bs-target="#modal-registration" href="">here</a>.</p>

          <!-- Modal Connexion -->
          <div class="modal fade" id="modal-connexion" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header mx-auto">
                        <h5 class="modal-title" id="">Sign into your Account</h5>
                    </div>
                    <div class="modal-body">
                        <form>
                            <div class="form-group input-group mb-3">
                                <span class="input-group-text"> <i class="fa fa-user fa-lg"></i> </span>
                                <input name="" class="form-control" data-toggle="tooltip" title="Enter your connexion name" placeholder="Full name" type="text" id="connexionName">
                            </div> <!-- form-group// -->
                            <div class="form-group input-group">
                                <span class="input-group-text"> <i class="fa fa-lock fa-lg"></i> </span>
                                <input class="form-control" placeholder="Enter password" type="password">
                                <i class="input-group-text fa fa-eye-slash"></i>
                            </div> <!-- form-group// -->
                        </form>
                    </div>
                    <div class="modal-footer mx-auto">
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Login</button>
                    </div>
                </div>
            </div>
          </div>
          <!-- End Modal Connexion -->
          <!-- Modal Registration-->
          <div class="modal fade" id="modal-registration" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header mx-auto">
                        <h5 class="modal-title" id="exampleModalLabel">Create a free Account</h5>
                    </div>
                    <div class="modal-body">
                        <div class="d-grid gap-2">
                            <a href="" class="btn btn-block btn-twitter"> <i class="fa fa-twitter"></i> Login via Twitter</a>
                            <a href="" class="btn btn-block btn-facebook"> <i class="fa fa-facebook-f"></i> Login via facebook</a>
                        </div>
                        <div class="divider-text"><span class="bg-light">OR</span></div>
                        <form>
                            <div class="form-group input-group mb-3">
                                <span class="input-group-text"> <i class="fa fa-user fa-lg"></i> </span>
                                <input name="" class="form-control" data-toggle="tooltip" title="This field must not be empty and should begin with alphabetic character" placeholder="Full name" type="text" id="name">
                            </div> <!-- form-group// -->

                            <div class="form-group input-group mb-3">
                                <span class="input-group-text"><i class="fa fa-envelope"></i></span>
                                <input name="" class="form-control" data-toggle="tooltip" title="Please type a valid email address" placeholder="Email address" type="email" id="email">
                            </div> <!-- form-group// -->
                            
                            <div class="form-group input-group">
                                <span class="input-group-text"> <i class="fa fa-lock fa-lg"></i> </span>
                                <input class="form-control" placeholder="Create password" type="password" title='Your password must be 8-20 characters long,  must contain special characters "!@#$%&*_?", numbers, lower and upper letters only.'>
                                <i class="input-group-text fa fa-eye-slash"></i>
                            </div> <!-- form-group// -->
                            
                            <!--Progress bar verification for strong passord -->
                            <div  class="progress mb-3" style="height: 15px;">
                              <div id="progressbar" class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 10%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <!--<small id="passwordHelpBlock" class="form-text text-muted">Your password must be 8-20 characters long,  must contain special characters "!@#$%&*_?", numbers, lower and upper letters only.</small>-->
                            <!--<div id="passwordStrength" class="text-center">STRONG</div>-->
                            <!--End of Progress bar and verification notices -->

                            <div class="form-group input-group mb-3">
                                <span class="input-group-text"> <i class="fa fa-lock fa-lg"></i> </span>
                                <input class="form-control" placeholder="Repeat password" type="password">
                                <i class="input-group-text fa fa-eye-slash"></i>
                            </div> <!-- form-group// -->

                            <div class="form-group d-grid gap-2 mb-3">
                                <button type="button" class="btn btn-primary btn-block" id="btn-createAccount"> Create Account  </button>
                            </div> <!-- form-group// -->
                            <div class="text-center">Have an account? <a href="">Log In</a> </div>
                        </form>
                    </div>
                    <!--<div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>-->
                </div>
            </div>
          </div>
          <!-- End Modal Registration -->
        </div>
      </div>
    </div>
    <div class="row g-5 p-4">
      <div class="col-sm-12 col-lg-6">
        <div class="p-3">
          <h2>Installation Instructions</h2>
          <ul class="">
            <li>First of all, You must have a linux distribution installed on your computer and the browser FireFox installed.</li>
            <li>Then, install Download Accelerator module integration of <a href="https://addons.mozilla.org/fr/firefox/addon/download_accelerator/">FireFox</a>.</li>
            <li>If you dont have snapstore installed, install it by typing on your favorite terminal <strong>sudo snap install snap-store</strong> on Ubuntu or <strong>snap install snap-store</strong> in superuser on others distributions.</li>
            <li>Install the Download Accelerator snap from <strong>snap-store</strong>.</li>
            <li>Launch Download Accelerator. This step is very important, to let the configuration of Download Accelerator snap.</li>
            <li>Retart your user session</li>
            <li>Once you are restart your session, Download Accelerator is ready to be use.</li>
          </ul>
            
        </div>
      </div>
    </div>
</div>
{% endblock content %}

{% block footer %}
<footer class="p-4" id="footer-download">
  <p class="text-center text-light"> Copyrights, developed by Messey Ã  Ndiomo</p>
</footer>
{% endblock footer %}


{% block js %}
<script>
$(function() {
    
    /**
     * management of password button
     */
    $('.fa-eye-slash').click(
      function () {
        var newType = $(this).siblings('input').attr('type') === 'password' ? 'text' : 'password';
        $(this).siblings('input').attr('type', newType);
        $(this).toggleClass('fa-eye-slash').toggleClass('fa-eye');
      }
    );
    

    /**
     * management of name submitting button
     */
    function userExist(username) {
      var ret = false;
      $.ajax({
        async: false,
        type: 'GET',
        url: "{% url 'downloadaccelerator:user' %}",
        data: {"username": username},
        success: function (response) {
          if (!response["valid"]) {
            ret = true;
          }
        }
      });
      return ret;
    }

    function createUser(username, email, password){
      var ret = false;
      $.ajax({
        async: false,
        type: 'GET',
        url: "{% url 'downloadaccelerator:createuser' %}",
        data: {"username": username, "email": email, "password": password},
        success: function (response) {
          if (response["register"]){
            ret = true;
          }
        }
      });
      return ret;
    }

    var percentage = 0;
    function checkProgressbar(n, m){
      if (n < 6) {
        percentage = 0;
        $("#progressbar").css("background", "#dd4b39");
      }
      else if (n < 8) {
        percentage = 20;
        $("#progressbar").css("background", "#9c27b0");
      }
      else if (n < 10) {
        percentage = 40;
        $("#progressbar").css("background", "#ff9800");
      }
      else {
        percentage = 60;
        $("#progressbar").css("background", "#4caf50");
      }
      // Check for the character-set constraints
      // and update percentage variable as needed.
           
      //Lowercase Words only
      if ((m.match(/[a-z]/) != null)) {
        percentage += 10;
      }
      //Uppercase Words only
      if ((m.match(/[A-Z]/) != null)) {
        percentage += 10;
      }
      //Digits only
      if ((m.match(/0|1|2|3|4|5|6|7|8|9/) != null)) {
        percentage += 10;
      }
      //Special characters
      if ((m.match(/\W/) != null) && (m.match(/\D/) != null)){
        percentage += 10;
      }
      // Update the width of the progress bar
      $("#progressbar").css("width", percentage + "%");
      /* print the password state on progress bar */
      if(percentage < 50){
        $('#progressbar').html('LOW');
      }
      else if(percentage < 70){
        $('#progressbar').html('NORMAL');
      }
      else if(percentage < 85){
        $('#progressbar').html('MEDIUM');
      }
      else if(percentage < 95){
        $('#progressbar').html('STRONG');
      }
      else{
        $('#progressbar').html('VERY STRONG');
      }
    }

    /* manage of keyup inside password input */
    $('input[placeholder = "Create password"]').keyup(
      function() {
        var m = $(this).val();
        var n = m.length;
        // Function for checking progress bar
        checkProgressbar(n, m);
      }
    );
    
    $('#btn-createAccount').click(
      function () {
        var nameClean = false;
        var emailClean = false;
        var passwordClean = false;

        if(($('#name').val().length === 0) | (!(/^[a-zA-Z][a-zA-Z0-9_-]*/.test($('#name').val())))){
          if(!$('#name').hasClass('border-danger'))
            $('#name').addClass('border-danger');
          $('#name').tooltip('dispose');
          $('#name').attr('title', 'This field must not be empty and should begin with alphabetic character').tooltip({placement: 'right'}).tooltip('show');
        }
        else if(userExist($('#name').val())){
          if(!$('#name').hasClass('border-danger'))
            $('#name').addClass('border-danger');
          $('#name').tooltip('dispose');
          $('#name').attr('title', 'A user with that name already exist. Suggest another name').tooltip({placement: 'right'}).tooltip('show');
        }
        else{
          if ($('#name').hasClass('border-danger')) {
            $('#name').removeClass('border-danger');
            $('#name').tooltip('disable');
          }
          nameClean = true;
        }
        if(($('#email').val().length === 0) |(!(/^[a-zA-Z](?:[a-zA-Z0-9_.-])*@[a-zA-Z]+\.[a-z]{2,5}/.test($('#email').val())))){
          if(!$('#email').hasClass('border-danger'))
            $('#email').addClass('border-danger');
          $('#email').tooltip({placement: 'right'}).tooltip('show');
        }
        else{
          if ($('#email').hasClass('border-danger'))
            $('#email').removeClass('border-danger');
          $('#email').tooltip('disable');
          emailClean = true;
        }
        if($('input[placeholder = "Create password"]').val() != $('input[placeholder = "Repeat password"]').val()){
          $('input[placeholder = "Create password"]').addClass('border-danger');
          $('input[placeholder = "Repeat password"]').addClass('border-danger');
          $('input[placeholder = "Repeat password"]').attr('title', 'This password is not equal to the previous! Please, fix this!').tooltip({placement: 'right'}).tooltip('show');
        }
        else if(percentage < 70){
          if (!$('input[placeholder = "Create password"]').hasClass('border-danger')) {
            $('input[placeholder = "Create password"]').addClass('border-danger');
          }
          $('input[placeholder = "Create password"]').attr('title', 'This password too weak. Please adjust it').tooltip({placement: 'right'}).tooltip('show');
        }
        else{
          if ($('input[placeholder = "Create password"]').hasClass('border-danger')) {
            $('input[placeholder = "Create password"]').removeClass('border-danger');
            $('input[placeholder = "Create password"]').tooltip('disable');
          }
          if ($('input[placeholder = "Repeat password"]').hasClass('border-danger')) {
            $('input[placeholder = "Repeat password"]').removeClass('border-danger');
            $('input[placeholder = "Repeat password"]').tooltip('disable');
          }
          passwordClean = true;
        }
        if(nameClean && emailClean && passwordClean){
          /* add user in the data base */
          createUser($('#name').val(), $('#email').val(), $('input[placeholder = "Create password"]').val());
        }
      }
    );

    /* initialisation of progress bar */
    checkProgressbar($('input[placeholder = "Create password"]').val().length, $('input[placeholder = "Create password"]').val());

  }
);
</script>
{% endblock js %}